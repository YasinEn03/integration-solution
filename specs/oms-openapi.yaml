openapi: 3.0.3
info:
  title: Shop AG
  version: 1.1.1
  description: |
    Gemeinsame OpenAPI-Spezifikation f체r Order Management Service (OMS)
    und Payment Service. F체r lokale Swagger-Tests sind die Server-URLs
    bereits CORS-sicher gesetzt (OMS relativ, Payments absolut auf localhost:3001).

servers:
  - url: /api
    description: Local OMS

tags:
  - name: OMS
    description: Order Management Endpunkte

paths:
  /orders:
    post:
      tags: [OMS]
      summary: Auftrag anlegen
      operationId: createOrder
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                items:
                  type: array
                  items:
                    type: object
                    properties:
                      productId:
                        type: integer
                      quantity:
                        type: integer
                firstName:
                  type: string
                lastName:
                  type: string
              required:
                - items
                - firstName
                - lastName
            examples:
              orderErfolgreich:
                summary: Erfolgreiche Bestellung
                value:
                  items:
                    - productId: 102
                      quantity: 1
                    - productId: 101
                      quantity: 2
                  firstName: amed
                  lastName: diyarbakir
              reservierungFehlgeschlagen:
                summary: Reservierung fehlgeschlagen
                value:
                  items:
                    - productId: 101
                      quantity: 111
                    - productId: 103
                      quantity: 12
                  firstName: amed
                  lastName: diyarbakir
              zahlungFehlgeschlagen:
                summary: Bestellung angelegt, Zahlung schl채gt fehl
                value:
                  items:
                    - productId: 101
                      quantity: 1
                    - productId: 103
                      quantity: 3
                  firstName: mock
                  lastName: mock
      responses:
        '201':
          description: Order erfolgreich angelegt
        '400':
          description: Ung체ltige Eingabe
        '409':
          description: Konflikt (z.B. doppelte Bestellung)
        '422':
          description: Reservierung fehlgeschlagen

  /orders/{orderId}:
    get:
      tags: [OMS]
      summary: Auftrag abrufen
      operationId: getOrder
      parameters:
        - name: orderId
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  orderId:
                    type: string
                  status:
                    type: string
                  items:
                    type: array
                    items:
                      type: object
                      properties:
                        productId:
                          type: integer
                        quantity:
                          type: integer
        '404':
          description: Order nicht gefunden
